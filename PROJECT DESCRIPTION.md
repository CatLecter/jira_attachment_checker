### Цели задачи:
1. Составить перечень файлов вложений (аттачей) находящихся в файловой системе;
2. Составить перечень Выгрузить информацию о всех файлах вложений из базы данных джиры;
3. Сделать анализ недостающих файлов в файловой системе (какие файлы прикреплены к задачам в джире, но отсутствуют на диске);
4. Сделать анализ целостности (по размеру файла filesize) файлов, которые есть в базе данных и в файловой системе;
5. Записать в отчет информацию по пунктам 3 и 4 с приложением списка потерянных файлов и битых файлов.

### Контекст:
1. Сотни тысяч задач
2. Сотни тысяч вложений и их файлов в файловой системе
3. Нельзя все читать разом из базы.
4. Нельзя читать файлы разом.

### Требования к задаче:
1. Скрипт должен работать только в определенное время (шедуллер по крону?), которое указывается через переменные окружения.
   Если время запуска в переменных окружения не указано, то скрипт работает непрерывно.
2. Читать данные из базы батчами/чанками:
  - разработать движок соединений с базой данных реализующий пулл соедиений;
  - количество соединений в пуле должно конфигурироваться через переменные окружения;
  - размер батча должен конфигурироваться через переменные окружения;
  - ходить в базу асинхронно;
  - не использовать ОРМ, чтобы не замедлять работу с базой.
3. Запоминать состояние чтобы не начинать заново при неудачном проходе:
  - записывать в sqlite (или др.) курсор (индентификатор последней успешно обработанной записи, может быть дату).
4. В первой итерации необходимо собрать:
  - названия файлов аттачей в файловой системе (это его айдишник в таблице fileattachment);
  - фактические имена аттачей (поле filename);
  - размер файла (поле filesize);
  - название задачи, к которой относится файл;
  - название проекта, к которому относится задача.
5. Проводим проверку наличия файлов итеративно по задачам:
  - проверка наличия файла в файловой системе;
  - проверка прав доступа к файлу;
  - проверка фактического размера файла с размером файла указанным в таблице.
6. Дополняем записи в sqlite инфомрацией о состоянии аттачментов.
7. Также запоминаем состояние.
8. Формируем отчет о проделанной работе:
  - в конце отработки программы;
  - опционально по отдельному запросу
  - пишем короткую информацию о результате
    (клличество аттачей всего в базе джиры,
    из них количество отсвутсвующих,
    с сломанными правами доступа, битые, количество задач с сломанными аттачами);
  - ссылки на сломанные аттачи пишем списком в отдельные txt файлы
    (файл с отсутствующими, файл с сломанными правами, файл с битыми аттачами)
9. Весь скрипт должен быть упакован в докер контейнер.

### Оценка:
  0. Подготовить локальную тестовую среду - поднять джиру, накидать аттачей для тестов - 3 часа.
  1. Разработка инфраструктуры скрипта (контейнеризация) 2 часа.
  2. Разработка шедуллера и его конфигурирование - 10 часов.
  3. Разработка асинхронного движка с пулом соединений, его конфигурирование - 3 часа.
  4. Разработать схему базы sqlite в соответствии с пунктом 4 требований - 1 час.
  5. Разработка асинхронного движка для sqlite, его конфигурирование - 1 час.
  6. Асинхронные репозитории для выполнения запросов в базы батчами, записать в sqlite результат, запомнить состояние - 20 часов.
  7. Разработать класс-чекер файлов с методами проверок на наличие файла, его права и целостность - 8 часов.
  8. Сервис формирования отчетов, записи отчетов в файлы - 8 часов.
  9. Логирование промежуточных этапов в файл логов скрипта - 2 часа.
  10. (Опционально) Нотификация о процессе и результате работы в телеграм (например) - 8 часов.
  11. Локальное тестирование работы скрипта - 2 часа.
  12. Деплой на стейдж - 2 часа.
  13. Тестирование на стейдже - 3 часа.
  14. Деплой на прод - 2 часа.
  15. (Опционально) Сопровождение - 5 часов.

  ## ВСЕГО: 80 часов.
